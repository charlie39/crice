#!/bin/sh
set -x
# A dmenu wrapper script for system functions.
WMcandidates=( i3 dwm river dwl bspwm )
for i in "${WMcandidates[@]}" ; do
    [ "$(pgrep $i)" ] && WM=$i && break
done
lock=i3lock
[ $XDG_SESSION_TYPE == "wayland" ] && lock="swaylock"

cmds="\
Lock Screen  @$lock -e -f -i $HOME/Pictures/Wallpapers/Arch-Dark/Kali-linux-themed-arch-1920x1080.jpg
Leave ${WM^^}    @kill -TERM $(pidof -s ${WM,,})
Refresh ${WM^^}  @kill -HUP $(pidof -s ${WM,,})
Reboot	     @sudo -A reboot
Shutdown     @sudo -A shutdown -h now
"

choice="$(echo "$cmds" | cut -d'@' -f1 | $DMENU -p "Choose:")" || exit 1
readonly action="$(echo "$cmds" | grep "^$choice" |  cut -d'@' -f2 )"
$action

