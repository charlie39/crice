#!/bin/sh

# Show wifi ðŸ“¶ and percent strength or ðŸ“¡ if none.
# Show ðŸŒ if connected to ethernet or âŽ if none.

case $BLOCK_BUTTON in
	1) $TERMINAL -e sudo wifi-menu ;;
	2) sudo wifi toggle > /dev/null && (wifi | (rg -q 'on' && echo "wifi is turning on .." || echo "wifi turning off..") | xargs -I {} notify-send {} ) ;;
	3) [ "$(wc -l < /proc/net/wireless )" -gt 2 ] && notify-send "$(ip -h -s link show wlo1 | awk 'NR==4||NR==6{print F" "$1};{F=$1;sub(/RX:/,"â¬‡",F);sub(/TX:/,"â¬†",F)}')" || \
		( notify-send -u low "ðŸŒ Internet module" "\- Click to connect
ðŸ“¡: no wifi connection
ðŸ“¶: wifi connection with quality
âŽ: no ethernet
ðŸŒ: ethernet working
" && notify-send "$(wifi | awk '{print $1" is "$3}')") ;;
	6) "$TERMINAL" -e "$EDITOR"  "$0" ;;
esac
grep -q "down" /sys/class/net/w*/operstate && wifiicon="ðŸ“¡" ||
	wifiicon="$(awk 'NR==3 { print "ðŸ“¶", int($3 * 100 / 70) "%" }' /proc/net/wireless )"

printf "%s %s\n" "$wifiicon" "$(sed "s/down/âŽ/;s/up/ðŸŒ/" /sys/class/net/e*/operstate)"
